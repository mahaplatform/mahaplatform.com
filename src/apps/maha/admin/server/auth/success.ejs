<script src="/js/localforage.min.js"></script>

<script>
  localforage.config({
    name: 'local',
    storeName: 'cache'
  });
  localforage.getItem('account').then(function (data) {
    if(!data) {
      data = {
        active: 0
      }
    }
    data.account = {
      id: <%= account.id %>,
      full_name: '<%= account.full_name %>',
      initials: '<%= account.initials %>',
      email: '<%= account.email %>',
      photo: <%- account.photo ? `'${account.photo}'` : 'null' %>,
      features: [<%- account.features.map(feature => `'${feature}'`).join(',') %>],
      token: '<%= account.token %>',
      authentication_strategy: '<%= account.authentication_strategy %>'
    }
    localforage.setItem('account', data).then(function () {
      window.location.href = "/admin";
    });
  });
</script>
