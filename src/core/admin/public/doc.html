<!DOCTYPE html>
<html lang="en-us">
<head>
  <title>Document Preview</title>
  <style>
    iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>

  <script type="application/javascript">

    function getParameterByName(name) {
      var url = window.location.href;
      var key = name.replace(/[\[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + key + "(=([^&#]*)|&|#|$)");
      var results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return results[2].replace(/\+/g, " ");
    }

    const url = getParameterByName('file');

    var src = 'https://docs.google.com/gview?embedded=true&url=' + url;

    document.write('<iframe id="viewer" src="'+src+'"></iframe>');

    const iframe = document.getElementById('viewer');

    function reloadIFrame() {
      iframe.src = src;
    }

    let timerId = setInterval("reloadIFrame();", 2000);

    iframe.onload = function() {
      clearInterval(timerId);
    }

  </script>

</body>
</html>
